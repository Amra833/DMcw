
-- Create the USERS table
CREATE TABLE users (
  id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  fullname VARCHAR2(100) NOT NULL,
  email VARCHAR2(100) NOT NULL UNIQUE,
  password VARCHAR2(255) NOT NULL
);

-- Insert sample user (password should be hashed in real usage)
INSERT INTO users (fullname, email, password)
VALUES ('Ann Perera', 'ann@example.com', 'admin123');

SELECT * FROM users;

DESCRIBE users;

SELECT owner, table_name FROM all_tables WHERE table_name = 'USERS';

GRANT INSERT ON SYSTEM.users TO system;
GRANT SELECT, INSERT ON SYSTEM.users TO system;
SELECT table_name FROM all_tables WHERE table_name = 'USERS';
GRANT ALL PRIVILEGES ON users TO system;
GRANT SELECT, INSERT, UPDATE, DELETE ON users TO system;
SELECT table_name FROM user_tables;

-- orders table
CREATE TABLE orders (
  id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  user_id NUMBER REFERENCES users(id),
  total_amount NUMBER(10, 2),
  delivery_address VARCHAR2(255),
  phone VARCHAR2(20),
  payment_status VARCHAR2(20) DEFAULT 'Pending',
  delivery_status VARCHAR2(20) DEFAULT 'Processing',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE payments (
  id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  order_id NUMBER REFERENCES orders(id),
  method VARCHAR2(50), -- e.g., 'COD', 'Bank Transfer'
  reference_id VARCHAR2(100), -- for manual/online payments
  status VARCHAR2(20) DEFAULT 'Pending',
  paid_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE deliveries (
  id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  order_id NUMBER REFERENCES orders(id),
  status VARCHAR2(50), -- 'Processing', 'Out for Delivery', etc.
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE products (
  id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name VARCHAR2(100) NOT NULL,
  description VARCHAR2(500),
  category VARCHAR2(100),
  price NUMBER(10, 2) NOT NULL,
  quantity NUMBER DEFAULT 0,
  image_url VARCHAR2(255),
  supplier_id NUMBER,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  CONSTRAINT fk_supplier
    FOREIGN KEY (supplier_id)
    REFERENCES suppliers(id)
    ON DELETE SET NULL
);

CREATE TABLE suppliers (
  id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name VARCHAR2(100) NOT NULL,
  location VARCHAR2(150),
  email VARCHAR2(100) UNIQUE,
  phone VARCHAR2(20),
  description VARCHAR2(500),
  image_url VARCHAR2(255),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);








